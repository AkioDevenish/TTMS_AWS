(function(c,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("d3"),require("vue")):typeof define=="function"&&define.amd?define(["exports","d3","vue"],m):(c=typeof globalThis<"u"?globalThis:c||self,m(c["vue3-simple-timeline"]={},c.D3,c.Vue))})(this,function(c,m,p){"use strict";function b(t){if(t&&t.__esModule)return t;const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const e in t)if(e!=="default"){const r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(i,e,r.get?r:{enumerable:!0,get:()=>t[e]})}}return i.default=t,Object.freeze(i)}const o=b(m),x=t=>i=>{let{timeScale:e,onEventClick:r}=t,n=i.selectAll("g.event").data(i.data()[0][0]),l=n.enter().append("g").classed("event",!0).attr("transform",a=>`translate(${e(a.start)} ${a.position*22})`).on("click",r);l.append("rect").attr("width",a=>a.end?e(a.end)-e(a.start):10).attr("height",20).attr("fill","rgba(85, 187, 238, 0.2)").attr("ry",6),l.append("text").attr("dy","1em").style("pointer-events","none").text(a=>a.name),n.attr("transform",a=>`translate(${e(a.start)} ${a.position*22})`).selectAll("rect").attr("width",a=>a.end?e(a.end)-e(a.start):10)};function $(t){return o.timeDay(t)<t?o.timeFormat("%I:%M")(t):o.timeMonth(t)<t?o.timeFormat("%b %d")(t):o.timeYear(t)<t?o.timeFormat("%B")(t):o.timeFormat("%Y")(t)}const k=t=>i=>{let{timeScale:e,height:r}=t,n=i.selectAll(".axe").data(a=>a),l=o.axisBottom().scale(e).tickFormat(a=>$(a));n.enter().append("g").attr("transform",`translate(0, ${r+5})`).classed("axe",!0).call(l),n.call(l)},E=t=>{let{timeScale:i,view:e,draw:r}=t;return o.zoom().on("zoom",n=>{let{k:l,x:a,y:u}=n.transform,d=o.zoomIdentity.translate(a,u).scale(l).rescaleX(i);e.call(r(d))})},z=t=>i=>{let{timeScale:e,height:r}=t,n=e(Date.now()),l=i.selectAll(".cursor").data(u=>u);l.enter().append("g").classed("cursor",!0).attr("transform",`translate(${n})`).append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",r).attr("stroke","red"),l.attr("transform",`translate(${n})`)};function O(t,i){let e=t.start,r=t.end,n=i.start,l=i.end;return!l||!r?!1:n<e&&e<l||e<n&&n<r}const T={generate(t){t.forEach(r=>{r.duration=r.end?r.end-r.start:0}),t.sort((r,n)=>n.duration-r.duration);let i=[];t.forEach(r=>{r.level=0,i.forEach(n=>{O(r,n)&&r.level++}),i.push(r)});let e=11;t.forEach(r=>r.position=e-r.level)}},j=t=>{function i(n){n.selectAll("svg").remove();let l=n.data(),a=l[0];T.generate(a);let{viewWidth:u=800,viewHeight:d=200,widthResizable:D=!0,margin:s,onEventClick:P,showCursor:R=!0}=t;D&&(u=n.node().clientWidth);let g=u-s.right-s.left,v=d-s.top-s.bottom,_=n.append("svg").datum(l).attr("width",g+s.right+s.left).attr("height",v+s.top+s.bottom),y=o.scaleTime().domain([o.min(a.map(f=>f.start)),o.max(a.map(f=>f.end))]).range([0,g]),w=_.append("g").classed("graph",!0).attr("transform",`translate(${s.left},${s.top})`).append("g").classed("view",!0);_.call(E({timeScale:y,view:w,draw:r})),w.call(r(y,P,v,R))}function e(n){e._init=()=>i(n),e._init(),t.widthResizable&&globalThis.addEventListener("resize",e._init,!0)}function r(n,l,a,u){return d=>{d.data(d.data()).call(x({timeScale:n,onEventClick:l})).call(k({timeScale:n,height:a})).call(z({showCursor:u,timeScale:n,height:a}))}}return e},S=(t,i)=>{const e=t.__vccOpts||t;for(const[r,n]of i)e[r]=n;return e},A={props:{data:{type:Array},config:{type:Object,default:()=>{}}},mounted(){var t;o.select("#timeline").datum(this.data).call(j({widthResizable:!0,viewHeight:300,margin:{top:0,bottom:30,left:15,right:15},onEventClick:(t=this.config)==null?void 0:t.onEventClick}))}},M={id:"timeline"};function C(t,i,e,r,n,l){return p.openBlock(),p.createElementBlock("div",M)}const h=S(A,[["render",C]]),F=[h],B={install:(t,i)=>{F.forEach(e=>{t.component(e.name,e)})}};c.VueTimeline=h,c.default=B,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
